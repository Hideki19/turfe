<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #divInicial {
            display: block;
        }

        #divReceberNomes {
            display: none;
        }
    </style>
</head>

<body>
    <div id="divInicial">
        <p>Número de cavalos: </p><input id="iptNumCavalos" type="number">
        <p> Número de voltas: </p> <input id="iptNumVoltas" type="number">
        <br>
        <br>
        <button onclick="cadastrarCavalo()">Seguinte</button>
    </div>
    <div id="divReceberNomes">
        <input id="iptNomeCavalo" type="text">
        <button id="btnCadastrarCavalo" onclick="cadastrarCavalo()">Cadastrar Cavalo</button>
        <button id="btnCorrida" onclick="corrida()">Começar corrida</button>
    </div>
    <div id="corrida">

    </div>
    <div id="texto"></div>
</body>

</html>

<script>

    var numCavalos = 0;
    var numVoltas = 0;
    var cavalos = [];


    function cadastrarCavalo() {
        numVoltas = Number(iptNumVoltas.value)
        numCavalos = Number(iptNumCavalos.value);
        divInicial.style.display = "none";
        divReceberNomes.style.display = "block";
        btnCorrida.style.display = "none";

        if (cavalos.lenght < numCavalos || cavalos.lenght == undefined) {

            if (iptNomeCavalo.value != "") {
                var nomeCavalo = iptNomeCavalo.value;
                cavalos.push({ nome: nomeCavalo, tempo: [], tempoTotal: [] });
                iptNomeCavalo.value = '';

                if (cavalos.length == numCavalos) {
                    btnCadastrarCavalo.style.display = "none";
                    btnCorrida.style.display = "block";
                    iptNomeCavalo.style.display = "none";
                }
            }

        }
    }

    function corrida() {
        divReceberNomes.style.display = "none";
        // var tempo = [];

        texto.innerHTML = '';

        for (let v = 0; v < numVoltas; v++) {
            texto.innerHTML += `Volta ${v + 1}<br>`

            
            // Sorteio dos tempos da volta de cada cavalo registrado
            for (let c = 0; c < cavalos.length; c++) {
                var rndNumero = (Math.random() * 2 + 7);
                cavalos[c].tempo.push(rndNumero);

                if (v == 0){
                    cavalos[c].tempoTotal.push(rndNumero);
                } else {
                    cavalos[c].tempoTotal.push((cavalos[c].tempoTotal[v-1])+rndNumero);
                }
                // cavalos[c].tempoTotal += cavalos[c].tempo[v];
            }

            // Organização do vetor cavalo para que fique sempre na ordem de posições da corrida
            cavalos.sort(function (a, b) {
                if (a.tempoTotal[v] < b.tempoTotal[v]) {
                    return -1;
                } else {
                    return true;
                }
            });
            console.log(cavalos);

            //Estrutura de repetição para mostrar os cavalos em suas respectivas funções
            for (let c = 0; c < cavalos.length; c++) {
                texto.innerHTML += `${c+1}° Lugar - ${cavalos[c].nome} - Tempo da volta:${cavalos[c].tempo[v].toFixed(2)} - Tempo total:${cavalos[c].tempoTotal[v].toFixed(2)}<br>`
            }


        }
    }
</script>